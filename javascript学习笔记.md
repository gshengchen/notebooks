# Javascript笔记
## 类型、变量和值
javascript数据类型分为：原始类型（primitive type）和 对象类型。
### 原始类型（primitive type）
包括数字、字符串和布尔值。null、undefined是个特殊的原始值，它不是其他原始类型，它代表各自类型的唯一成员。
### 对象类型（object type）
都可以定义方法，除了null、undefined。
### 变量
变量是无类型的（untypeed），变量可以被赋予任何类型的值，也可以重新赋予不同类型的值。使用var来声明变量。
### 数字、直接量
数字不区分整数与浮点数，javascript中所有的数值都是用64位浮点值来表示。然而，实际操作中（比如，位操作、数组索引）则是基于32位整数。数字表示法有：整数、指数、浮点数、16进制、8进制（有的不支持）等。数字运算除了基本的运算符以外，还可以使用Math对象的属性方法和常量来运算。
* javascript上溢（overflow）、下溢（underflow）或除以0都不会报错。数字运算结果超过上限，结果是一个特殊值Infinity（或者-Infinity）。基于Infinity运算都是Infinity。下溢javascript结果返回0，负数则返回-0。  
* 非0的数除以0，返回Infinity 或者 -Infinity。  
* 0除以0、无穷大除以无穷大、给负数开方以及运算符与无法转换为数字的操作数一起使用时，返回NaN。  
* NaN和任何值不想等，用 x != x 判断。
```javascript
isNaN(); //参数是NaN或者是对象、字符串，返回true
isFinite();//参数不是NaN、Infinity和-Infinity，返回true
```  
* 零值与负零值是相等的，除了作为除数
```javascript
var zero = 0;
var negz = -0;
zero === negz //true;
1 / zero === 1/negz //flase,Infinity与-Infinity不想等
```  

### 日期与时间
Date（）构造函数来创建日期和时间对象。
```javascript
var then =new Date(2016，0,11);//创建2016.0.11日期对象
var now = new Date();//当前日期和时间
now.getFullTear();//获得年
now.getMonth();//获得月份，从0开始计算
now.getDate();//获得日
now.getDay();//获得周几，0表示星期日
now.getHours();//获得小时
now.getUTCHours();//使用UTC表示小时时间，基于时区
```  
### 文本
字符串是一组由16位值组成的不可变的有序序列。javascript没有字符类型，javascript中各式字符串操作方法均作用于16位值，而非字符。
* 字符串直接量就是有单引号或者双引号括起来的字符序列。  
* 转义符号是反斜线\\,也可以用来拆分行。  
* 如果操作数是字符，“+”则表示字符串连接。  
* 字符串提供许多可以调用的方法与属性。  
```javascript
var s = "Hello world!";
s.charAt(0);//'h' 返回第一个字符
s.charAt(s.length-1);//返回最后一个字符
s.substring(1,4)//第2~4个字符
s.replace("H","h");//返回hello world！
```  
* 字符串是不变的，类似replace方法返回的是新字符。
* 字符串可以当作只读数组，用索引来访问字符串中的字符。  

### 模式匹配
RegExp（）构造函数，用来创建表示文本匹配模式的对象，这些模式就是正则表达式。正则表达式的直接量就是两个斜线"/"中的文本，第二条斜线之后也可以跟随一个或多个字母，用来修饰匹配模式的含义。
```javascript
var text="testing:1,2,3";
var pattern=/d+/g;
pattern.test(text); //匹配成功，返回true
text.search(pattern);//返回首次匹配成功的位置
text.match(pattern);//所有匹配组成的数组
text.replace(pattern,'#');//
text.split(/\D+/);//
```
### 布尔值
布尔类型只有两个值true和false。任何javascript的值都可以转换成布尔值。undefined、null、0、-0、NaN以及空字符串都转换成false，他们称为假值。所有其他值转换成true，称为真值。布尔值包含toString（）方法，它返回true、false。
### null与undefined
null表示一个特殊值，常用来描述“空值”。用typeof运算符返回object，null可以认为是一个特殊的对象值。可以表示数字、字符串和对象是无值的。undefined用未定义的值来表明变量没有初始化，如果要查询对象属性或数组元素的值返回undefined，则说明这个属性或元素不存在；如果函数没有返回值，则返回undefined；引用没有提供实参的函数形参也会得到undefined。null与undefined都表示”值的空缺”，判断相等运算符“==”认为两者相等（可用===区分）。undefined表示系统级的，而null程序级，如果赋值给变量或者属性，或者作为参数传入函数，最佳选择是使用null。
### 全局对象
全局对象的属性是全局对象的属性是全局定义的符号，可以直接使用。当javascript解释器启动时（或者加载页面时），它创造一个新的全局对象，并给它一组定义的初始属性：
* 全局属性：undefined、Infinity、NaN等
* 全局函数：isNaN、isFinite、parseInt、eval等。
* 构造函数：Date（）、RegExp()、String（）、Object（）、Array（）
* 全局对象：如Math、JSON
* 在代码的最顶级（不在任何函数内），可以用this来引用全局对象。
* 在客户端，Window对象充当全局对象，这个全局对象有个属性window来引用自身，它可以代替this来引用全局对象。
* 如果代码声明一个全局变量，它就是全局对象的一个属性。  

### 包装对象
javascript对象是一种复合值。通过'.'来引用属性值。当属性值是一个函数时，称其为方法。
* 字符串不是对象，但它也有属性与方法。其实是javascript通过new String(s)的方式转换成对象，这个对象继承字符串方法，一旦引用结束，这个对象就销毁了（不一定创建或销毁这个临时对象，看起来像这个过程）。
* 同字符串一样，布尔值与数字也有构造函数：Boolean（）、Number（）来创建临时对象。
* null、undefined没有包装对象。
* 在读取数字、字符串、布尔值的属性值（或方法）时，表现像对象一样。但如果试图给其属性赋值，则会忽略这个操作。因为，修改只是发生在临时对象上。
* 由于数字、字符串、布尔值的属性都是只读的，并且不能定义新属性，它们是有别于对象的。
* 可以用构造函数，显示创建包装对象。在必要时包装对象转换成原始值。包装对象与原始对象用”==”运算符相等，“===”不等。通过typeof运算符可以看到不同。  

### 不可变的原始值与可变的对象
对象也称为引用类型，对象的比较其实引用的比较，只有仅当它们引用同一个对象时才相等。  
### 类型转换
* 以数字表示的字符串可以直接转换为数字，如果有非空格字符转换数字的结果NaN。
* true 转换为1，false转换为0，空字符串转换为0。
* 原始值到对象的转换，通过构造函数转换成各自包装对象。null、undefined例外，它们会造成TypeError异常。
* 对象到布尔值转换true。
* 对象到字符串和对象到数字是通过调用方法来完成。所有对象继承了两个转换方法。
* toString：默认的toString并不返回一个有趣的值，许多类定义了特定的toString版本
* valueOf:它默认将对象转换为表示它的原始值。大多数对象无法表示一个原始值。因此valueOF方法简单返回对象的本身。
* 对象到字符串转换：使用toString，如果没有或者不能返回一个原始值则使用valueOf，两者没有，抛出异常。对象到数字，先使用valueOf。
* “==”运算符从不试图将操作数转换为布尔值。
* 显示转换最简单的方法使用Boolean、Object、Number、String等构造函数。
* 隐式转换："+" 如果一个操作数是字符串，另一个操作数转换为字符串，一元'+'操作符将其操作数转换为数字，一元'!'将其操作数转换为布尔值并取反。+、== 应用对象到原始值转换。  

### 变量声明
使用一个变量之前，应该先声明，变量是用var来声明。声明一个变量，如果没有初始化，它的初始化的值是undefined。使用var重复声明是允许的，如果重复声明带有初始化器，与赋值没什么两样。
* 在ES5中，给一个没有声明的变量赋值会报错，在非严格模式下，如果给一个未声明变量赋值，实际上会给全局对象创建一个同名属性，并且它看起来像一个全局变量。
* 一个变量作用域是程序源代码中定义这个变量的区域。在函数体内局部变量优先级高于全局变量。
* 函数定义是可以嵌套的，每个函数都有作用域，因此会出现几个局部作用域嵌套的情况。
* 函数作用域：变量在它声明的函数体以及这个函数体嵌套的任意函数体内都是有定义的，同时，始终可见。这就意味变量在声明之前甚至可用，这个特性称为声明提前，即函数里声明的所有变量（但不涉及赋值）都被提前至函数顶部。
* 声明一个全局变量时，实际定义一个全局对象的属性，用var声明的全局变量是不可配置的，也就是说不能用delete删除。而不要var声明的变量，它是全局变量，同时，是可配置的。
* 全局变量是全局对象的属性。而局部变量当做跟函数调用相关的某个对象的属性。这个对象称为调用对象（call object）（ES5 中称为声明上下文对象）。this可以引用全局对象，却没有方法可以引用局部变量中存放的对象。  

### 作用域链
全局变量在程序中始终有定义的，而局部变量在声明它的函数体内以及其所嵌套的函数内部始终是有定义的。
每个javascript代码都有一个作用域链，作用域链是一个对象列表或链，这组对象定义了这段代码作用域中的变量。对象链创建规则是：当定义一个函数时，它实际上保存一个作用域链，当调用此函数时，它创建一个新的对象来存储它的局部变量，并将此对象添加至保存的那个作用域上，同时创建一个新的更长的表示函数调用作用域的链。  
## 表达式与运算符
表达式是一个javascript短语，解释器将其求值。常量、变量名都是表达式，简单的表达式通过运算符组合成复杂的表达式，如，数组、函数调用等。
### 原始表达式
最简单的表达式就是原始表达式（primary expression），是表达式的最小单位。它包括：常量或直接量、变量和一些关键字。特别注意的是，如果变量名不存在，表达式的运算结果是undefined，而在ES5严格模式中，则抛出引用错误。
### 对象和数组的初始化表达式
这些有时称“对象直接量”和“数组直接量”，它们是创建新的对象和数组，它们所包含的成员或者元素都是子表达式。  
- 数组初始化表达式 ：元素可以是任何表达式，也就是可以嵌套的。
```javascript
[] //空数组
[1+2, 2+3] //2个元素数组，3.7
var matrix = [[1,2,3],[4,5,6],[7,8,9]]//数组嵌套
```   
- 数组初始化表达式进行求值时，它的元素表达式也要计算一次，也就是说每次计算的值有可能不同。  
- 数组列表逗号之间的元素可以省略，省略的元素的值是undefined，但再结尾的逗号不产生undefined元素。  
- 对象初始化表达式的每个子表达式都包含一个属性和一个冒号作为前缀的值，也可以嵌套：  
```javascript
var p ={x:2.4,y:-1.2};//
var q = {}; //空对象
var rectangle = {upperLeft : {x : 2, y : 3}, lowerRight : {x : 4 , y : 5}};
```  
- 对象表达式的值可以是任何javascript的表达式，而，属性名可以是字符串而不是标识符。
```javascript
var side = 1;
var square = {"upperLeft" : {x : p.x , y ：p.y},"lowerRight" :{x : p.x + side, y : p.y + size}}
```

### 函数定义表达式
函数定义表达式定义一个函数，是函数的直接量。
```javascript
var square = function(x){return x * x ;}
```

### 属性访问表达式
属性访问表达式运算得到一个对象属性或一个数组元素的值。有两种语法方式：
```javascript
expression.identifer
expression[expression]
```  
- 第一种方法：表达式指定对象，标识符指定需要访问的属性名称。
- 第二种方法：第一表达式指定对象，第二表达式指定需要访问的属性名称或数组索引。
```javascript
var o = {x : 1 , y : {z : 3}};//一个示例对象
var a = [o , 4 , [5 , 6]];//一个包含对象的数组
o.x // 值 1：表达式o的x属性
o.y.z // 值 3 ：表达式o.y的z属性
o["x"] //值 1 :表达式o的x属性
a[1] // 值 4：表达式a 中索引为1的元素
a[2]["1"] //值 6：表达式a[2]中索引为1的元素
a[0].x //值 1 ：表达式a[0]的x属性。
```

### 调用表达式
作为方法调用中，作为属性访问主体对象和数组便是其调用方法内this的指向。而其他调用表达式通常使用全局对象作为this关键字的值，而ES5严格模式中，this并不指向全局对象，它的值是undefined。
### 对象创建表达式
创建一个对象并调用构造函数初始化新对象的属性。如果，不需要传入参数给构造函数的话，括号可以省略。
```javascript
new Object();
new Point(2,3);
new Object;
new Date;
```  
### 运算符概况
优先级：一元-》算术-》位移-》关系（比较）-》按位-》逻辑-》三元-》赋值。运算符的优先级和结合性规定了在复杂的表达式中的运算顺序。子表达式在javascript总是按照从左到右的顺序来计算子表达式。
#### 算术运算符
基本的算术运算符是*、/、+、-。在必要时将操作数转换为数字。所有无法转换为数字的操作数都转换为NaN值，如果操作数是NaN值，结果也是NaN。
- 除法的结果是浮点类型
- % 结果的符号与第一的操作数的符号保持一致。
- 运算符+可以对两个数字做加法，也可以做字符串连接。
